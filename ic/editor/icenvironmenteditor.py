#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Окно редактирования окружения проекта.
"""

import wx
import ic.components.icResourceParser as prs
from ic.utils import util
import ic.interfaces.icobjectinterface as icobjectinterface

from ic.log import log
from ic.engine import glob_functions

### !!!! Данный блок изменять не рекомендуется !!!!
###BEGIN SPECIAL BLOCK
#   Resource description of class
resource = {'activate': 1, 'obj_module': None, 'show': 1, 'recount': None, 'refresh': None, 'border': 0, 'size': (700, 400), 'style': 536877056, 'foregroundColor': None, 'span': (1, 1), 'fit': False, 'title': 'Содержание контекста:', 'component_module': None, 'proportion': 0, 'source': None, 'backgroundColor': None, 'type': 'Dialog', 'res_module': None, 'enable': True, 'description': None, 'onClose': None, '_uuid': '0ad15ccc4d095715387d2eccb12a879a', 'moveAfterInTabOrder': '', 'killFocus': None, 'flag': 0, 'child': [{'activate': 1, 'obj_module': None, 'data_name': None, 'border': 5, 'size': (-1, -1), 'style': 0, 'span': (1, 1), 'component_module': None, 'proportion': 0, 'type': 'BoxSizer', 'res_module': None, 'hgap': 0, 'description': None, '_uuid': 'cfdb87f8-1a17-41c6-98fb-62785673fc67', 'flag': 8192, 'child': [{'image_size': (16, 16), 'activate': 1, 'obj_module': None, 'show': 1, 'child': [{'activate': 1, 'obj_module': None, 'show': 1, 'recount': None, 'refresh': None, 'border': 0, 'size': (-1, -1), 'onRightMouseClick': None, 'moveAfterInTabOrder': '', 'foregroundColor': None, 'span': (1, 1), 'component_module': None, 'proportion': 0, 'source': None, 'onLeftMouseClick': None, 'backgroundColor': None, 'type': 'Panel', 'res_module': None, 'enable': True, 'description': None, 'onClose': None, '_uuid': 'eae7af89a80b33eb5c47f3cf5f2e3f40', 'style': 524288, 'docstr': 'ic.components.icwxpanel-module.html', 'flag': 8192, 'child': [{'hgap': 0, 'activate': 1, 'obj_module': None, 'data_name': None, 'border': 5, 'size': (-1, -1), 'style': 0, 'span': (1, 1), 'alias': None, 'component_module': None, 'proportion': 0, 'type': 'BoxSizer', 'res_module': None, 'description': None, '_uuid': 'a178b9f0-76a4-4eba-9316-4bf927edef1d', 'flag': 8192, 'child': [{'type': 'SimpleObjectListView', 'name': 'view_list', 'description': None, 'child': [{'type': 'GridCell', 'name': 'name', 'label': 'Наименование', 'width': 200, 'attr': 'W', 'pic': 'S', 'cell_attr': {'type': 'cell_attr', 'name': '', '_uuid': None, 'backgroundColor': (255, 255, 255), 'foregroundColor': (0, 0, 0), 'font': {'__attr_types__': {}, 'type': 'Font', 'name': 'defaultFont', 'size': 8, 'family': None, 'faceName': '', 'style': None, 'underline': False}, 'alignment': ('left', 'top'), '__lists__': {'alignment': ["('left', 'top')", "('right', 'top')", "('centre', 'top')", "('left', 'centre')", "('right', 'centre')", "('centre', 'centre')", "('left', 'bottom')", "('right', 'bottom')", "('centre', 'bottom')"]}, '__attr_types__': {0: ['type', 'name', 'alias', '_uuid'], 8: ['backgroundColor', 'foregroundColor'], 9: ['font'], 1: ['alignment']}, '__item_id': 7}, 'getvalue': '', 'setvalue': '', 'hlp': None, 'ctrl': None, 'init': None, 'recount': None, 'valid': None, 'sort': None, 'nsi_psp': None, 'shortHelpString': '', 'keyDown': None, 'get_grp_key': None, 'get_grp_title': None, '__styles__': {'DEFAULT': 0}, '__events__': {'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False)}, '__lists__': {'attr': ['W', 'R', 'C', 'cr'], 'pic': ['S', 'TEXT', 'N', 'F', 'DT', 'B', 'CH', 'NSI', 'XXXX', '9999', '999,999.99']}, '__attr_types__': {12: ['init_expr', 'description', 'keyDown', 'pre_init_expr'], 40: ['width'], 1: ['pic', 'attr'], 0: ['type', 'name', 'pic', 'alias', 'data_name', 'label'], 16: ['nsi_psp'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__parent__': {'name': 'base', 'type': 'Base', 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': None, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_types__': {12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': 'ee1ae5c1-d053-40a9-bff3-61254a4204ad', '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': 6, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, {'type': 'GridCell', 'name': 'value', 'label': 'Значение', 'width': 500, 'attr': 'W', 'pic': 'S', 'cell_attr': {'type': 'cell_attr', 'name': '', '_uuid': None, 'backgroundColor': (255, 255, 255), 'foregroundColor': (0, 0, 0), 'font': {'__attr_types__': {}, 'type': 'Font', 'name': 'defaultFont', 'size': 8, 'family': None, 'faceName': '', 'style': None, 'underline': False}, 'alignment': ('left', 'top'), '__lists__': {'alignment': ["('left', 'top')", "('right', 'top')", "('centre', 'top')", "('left', 'centre')", "('right', 'centre')", "('centre', 'centre')", "('left', 'bottom')", "('right', 'bottom')", "('centre', 'bottom')"]}, '__attr_types__': {0: ['type', 'name', 'alias', '_uuid'], 8: ['backgroundColor', 'foregroundColor'], 9: ['font'], 1: ['alignment']}, '__item_id': 9}, 'getvalue': '', 'setvalue': '', 'hlp': None, 'ctrl': None, 'init': None, 'recount': None, 'valid': None, 'sort': None, 'nsi_psp': None, 'shortHelpString': '', 'keyDown': None, 'get_grp_key': None, 'get_grp_title': None, '__styles__': {'DEFAULT': 0}, '__events__': {'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False)}, '__lists__': {'attr': ['W', 'R', 'C', 'cr'], 'pic': ['S', 'TEXT', 'N', 'F', 'DT', 'B', 'CH', 'NSI', 'XXXX', '9999', '999,999.99']}, '__attr_types__': {12: ['init_expr', 'description', 'keyDown', 'pre_init_expr'], 40: ['width'], 1: ['pic', 'attr'], 0: ['type', 'name', 'pic', 'alias', 'data_name', 'label'], 16: ['nsi_psp'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__parent__': {'name': 'base', 'type': 'Base', 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': None, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_types__': {12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': '186a819f-4c83-457c-8e9c-ef5fa8ea5dee', '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': 8, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, {'type': 'GridCell', 'name': 'access', 'label': 'Права доступа', 'width': 100, 'attr': 'W', 'pic': 'S', 'cell_attr': {'type': 'cell_attr', 'name': '', '_uuid': None, 'backgroundColor': (255, 255, 255), 'foregroundColor': (0, 0, 0), 'font': {'__attr_types__': {}, 'type': 'Font', 'name': 'defaultFont', 'size': 8, 'family': None, 'faceName': '', 'style': None, 'underline': False}, 'alignment': ('left', 'top'), '__lists__': {'alignment': ["('left', 'top')", "('right', 'top')", "('centre', 'top')", "('left', 'centre')", "('right', 'centre')", "('centre', 'centre')", "('left', 'bottom')", "('right', 'bottom')", "('centre', 'bottom')"]}, '__attr_types__': {0: ['type', 'name', 'alias', '_uuid'], 8: ['backgroundColor', 'foregroundColor'], 9: ['font'], 1: ['alignment']}, '__item_id': 11}, 'getvalue': '', 'setvalue': '', 'hlp': None, 'ctrl': None, 'init': None, 'recount': None, 'valid': None, 'sort': None, 'nsi_psp': None, 'shortHelpString': '', 'keyDown': None, 'get_grp_key': None, 'get_grp_title': None, '__styles__': {'DEFAULT': 0}, '__events__': {'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False)}, '__lists__': {'attr': ['W', 'R', 'C', 'cr'], 'pic': ['S', 'TEXT', 'N', 'F', 'DT', 'B', 'CH', 'NSI', 'XXXX', '9999', '999,999.99']}, '__attr_types__': {12: ['init_expr', 'description', 'keyDown', 'pre_init_expr'], 40: ['width'], 1: ['pic', 'attr'], 0: ['type', 'name', 'pic', 'alias', 'data_name', 'label'], 16: ['nsi_psp'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__parent__': {'name': 'base', 'type': 'Base', 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': None, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_types__': {12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': '8a4cdac0-2038-4c2c-babb-5fe07220067a', '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': 10, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, {'type': 'GridCell', 'name': 'lock_key', 'label': 'Ключ блок.', 'width': 100, 'attr': 'W', 'pic': 'S', 'cell_attr': {'type': 'cell_attr', 'name': '', '_uuid': None, 'backgroundColor': (255, 255, 255), 'foregroundColor': (0, 0, 0), 'font': {'__attr_types__': {}, 'type': 'Font', 'name': 'defaultFont', 'size': 8, 'family': None, 'faceName': '', 'style': None, 'underline': False}, 'alignment': ('left', 'top'), '__lists__': {'alignment': ["('left', 'top')", "('right', 'top')", "('centre', 'top')", "('left', 'centre')", "('right', 'centre')", "('centre', 'centre')", "('left', 'bottom')", "('right', 'bottom')", "('centre', 'bottom')"]}, '__attr_types__': {0: ['type', 'name', 'alias', '_uuid'], 8: ['backgroundColor', 'foregroundColor'], 9: ['font'], 1: ['alignment']}, '__item_id': 13}, 'getvalue': '', 'setvalue': '', 'hlp': None, 'ctrl': None, 'init': None, 'recount': None, 'valid': None, 'sort': None, 'nsi_psp': None, 'shortHelpString': '', 'keyDown': None, 'get_grp_key': None, 'get_grp_title': None, '__styles__': {'DEFAULT': 0}, '__events__': {'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False)}, '__lists__': {'attr': ['W', 'R', 'C', 'cr'], 'pic': ['S', 'TEXT', 'N', 'F', 'DT', 'B', 'CH', 'NSI', 'XXXX', '9999', '999,999.99']}, '__attr_types__': {12: ['init_expr', 'description', 'keyDown', 'pre_init_expr'], 40: ['width'], 1: ['pic', 'attr'], 0: ['type', 'name', 'pic', 'alias', 'data_name', 'label'], 16: ['nsi_psp'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__parent__': {'name': 'base', 'type': 'Base', 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': None, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_types__': {12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}, 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': 'c6beec6b-df05-4367-8e57-caa725322061', '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': 12, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта'}}], 'activate': True, 'init_expr': None, '_uuid': '2e0a9f95-ec43-419b-b373-a0eaf2233288', 'evenRowsBackColor': None, 'oddRowsBackColor': None, 'data_src': None, 'get_dataset': None, 'sortable': True, 'selected': None, 'activated': None, 'conv_record': None, 'conv_dataset': None, 'row_text_color': None, 'row_background_color': None, '__styles__': {'DEFAULT': 0}, '__events__': {'selected': ('wx.EVT_LIST_ITEM_SELECTED', 'OnItemSelected', False), 'activated': ('wx.EVT_LIST_ITEM_ACTIVATED', 'onItemActivated', False), 'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False), 'onInit': ('icEvents.EVT_POST_INIT', 'OnInit', False)}, '__attr_types__': {0: ['type', 'name', 'description', 'data_name', 'alias', 'moveAfterInTabOrder', 'field_name', 'label'], 2: ['enable', 'sortable', 'activate'], 8: ['backgroundColor', 'evenRowsBackColor', 'foregroundColor', 'oddRowsBackColor'], 16: ['data_src'], 12: ['init_expr', 'show', 'recount', 'description', 'pre_init_expr', 'refresh', 'source', 'keyDown'], 9: ['font'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 40: ['proportion', 'border'], 1: ['layout', 'alignment'], 17: ['res_module', '_uuid', 'obj_module']}, '__parent__': {'name': 'widget', 'type': 'Widget', 'foregroundColor': None, 'backgroundColor': None, 'show': 1, 'refresh': None, 'enable': True, 'recount': None, 'source': None, 'keyDown': None, 'onInit': None, 'moveAfterInTabOrder': '', '__events__': {'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False), 'onInit': ('icEvents.EVT_POST_INIT', 'OnInit', False)}, '__version__icwidget': '0.0.0.0', '__attr_types__': {0: ['moveAfterInTabOrder', 'field_name', 'label'], 12: ['show', 'refresh', 'recount', 'source', 'keyDown'], 8: ['foregroundColor', 'backgroundColor'], 2: ['enable'], 9: ['font']}, '__parent__': {'name': 'base', 'type': 'Base', 'size': (-1, -1), 'position': (-1, -1), 'span': (1, 1), 'proportion': 1, 'flag': 8192, 'border': 5, '__attr_types__': {10: ['position', 'span'], 11: ['size'], 7: ['flag'], 40: ['border', 'proportion'], 1: ['layout', 'alignment']}, '__lists__': {'layout': ['vertical', 'horizontal'], 'alignment': ["('left', 'middle')", "('left', 'top')", "('left', 'bottom')", "('centred', 'middle')", "('centred', 'top')", "('centred', 'bottom')", "('right', 'middle')", "('right', 'top')", "('right', 'bottom')"]}, '__parent__': {'name': 'base', 'type': 'Base', 'alias': None, 'activate': True, 'style': 0, 'init_expr': None, 'component_module': None, 'res_module': None, 'obj_module': None, 'description': None, 'data_name': None, '_uuid': None, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__item_id': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_types__': {12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 7: ['style'], 2: ['activate']}, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'foregroundColor': 'Цвет текста', 'backgroundColor': 'Цвет фона', 'show': 'Признак видимости', 'enable': 'Вкл./Выкл. объект', 'onInit': 'Обработчик инициализации объекта', 'keyDown': 'Обработчик нажатия кнопки клавиатуры', 'data_src': 'Паспорт источника данных', 'get_dataset': 'Функция получения данных в виде списка словарей', 'sortable': 'Можно сортировать?', 'selected': 'Выбор элемента', 'activated': 'Активация элемента', 'conv_record': 'Преобразование записи', 'conv_dataset': 'Преобразование набора записи', 'row_text_color': 'Получение цвета текста строки', 'row_background_color': 'Получение цвета фона строки'}}, '__attr_hlp__': {'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента'}}, '__attr_hlp__': {'foregroundColor': 'Цвет текста', 'backgroundColor': 'Цвет фона', 'show': 'Признак видимости', 'enable': 'Вкл./Выкл. объект', 'onInit': 'Обработчик инициализации объекта', 'keyDown': 'Обработчик нажатия кнопки клавиатуры'}}, '__attr_hlp__': {'data_src': 'Паспорт источника данных', 'get_dataset': 'Функция получения данных в виде списка словарей', 'sortable': 'Можно сортировать?', 'selected': 'Выбор элемента', 'activated': 'Активация элемента', 'conv_record': 'Преобразование записи', 'conv_dataset': 'Преобразование набора записи', 'row_text_color': 'Получение цвета текста строки', 'row_background_color': 'Получение цвета фона строки'}, '__doc__': '', 'foregroundColor': None, 'backgroundColor': None, 'show': 1, 'refresh': None, 'enable': True, 'recount': None, 'source': None, 'keyDown': None, 'onInit': None, 'moveAfterInTabOrder': '', '__version__icwidget': '0.0.0.0', 'size': (-1, -1), 'position': (-1, -1), 'span': (1, 1), 'proportion': 1, 'flag': 8192, 'border': 5, '__lists__': {'layout': ['vertical', 'horizontal'], 'alignment': ["('left', 'middle')", "('left', 'top')", "('left', 'bottom')", "('centred', 'middle')", "('centred', 'top')", "('centred', 'bottom')", "('right', 'middle')", "('right', 'top')", "('right', 'bottom')"]}, 'alias': None, 'style': 0, 'component_module': None, 'res_module': None, 'obj_module': None, 'data_name': None, '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__item_id': 5, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None}], 'layout': 'vertical', 'name': 'DefaultName_1955', 'init_expr': None, 'position': (0, 0), 'vgap': 0, '__item_id': 4, '__attr_types__': {40: ['border', 'proportion', 'vgap, hgap'], 1: ['layout', 'alignment'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 12: ['init_expr', 'description', 'pre_init_expr'], 0: ['type', 'name', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 2: ['activate']}, '__lists__': {'layout': ['vertical', 'horizontal']}, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'vgap': 'Величина зазора между соседними ячейками по вертикали', 'hgap': 'Величина зазора между соседними ячейками по горизонтали', 'layout': 'Ориентация сайзера'}}], 'name': 'page1', 'data_name': None, 'keyDown': None, 'alias': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, '__item_id': 3, '__attr_types__': {12: ['refresh', 'init_expr', 'show', 'source', 'description', 'recount', 'onClose', 'keyDown', 'pre_init_expr'], 0: ['docstr', 'type', 'name', 'data_name', 'alias', 'moveAfterInTabOrder', 'field_name', 'label'], 8: ['foregroundColor', 'backgroundColor'], 2: ['enable', 'activate'], 9: ['font'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 40: ['border', 'proportion'], 1: ['layout', 'alignment'], 17: ['res_module', '_uuid', 'obj_module']}, '__default_page__': 1, '__events__': {'onClose': ('wx.EVT_CLOSE', 'destroyObj', False), 'onLeftMouseClick': ('wx.EVT_LEFT_DOWN', 'onLeftDown', False), 'onRightMouseClick': ('wx.EVT_RIGHT_DOWN', 'onRightDown', False), 'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False), 'onInit': ('icEvents.EVT_POST_INIT', 'OnInit', False)}, '__version__icwidget': '0.0.0.0', '__lists__': {'layout': ['vertical', 'horizontal'], 'alignment': ["('left', 'middle')", "('left', 'top')", "('left', 'bottom')", "('centred', 'middle')", "('centred', 'top')", "('centred', 'bottom')", "('right', 'middle')", "('right', 'top')", "('right', 'bottom')"]}, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'foregroundColor': 'Цвет текста', 'backgroundColor': 'Цвет фона', 'show': 'Признак видимости', 'enable': 'Вкл./Выкл. объект', 'onInit': 'Обработчик инициализации объекта', 'keyDown': 'Обработчик нажатия кнопки клавиатуры'}}, {'activate': 1, 'obj_module': None, 'show': 1, 'recount': None, 'refresh': None, 'border': 0, 'size': (-1, -1), 'onRightMouseClick': None, 'moveAfterInTabOrder': '', 'foregroundColor': None, 'span': (1, 1), 'component_module': None, 'proportion': 0, 'source': None, 'onLeftMouseClick': None, 'backgroundColor': None, 'type': 'Panel', 'res_module': None, 'enable': True, 'description': None, 'onClose': None, '_uuid': '19125fb18a8a3637d184598750760926', 'style': 524288, 'docstr': 'ic.components.icwxpanel-module.html', 'flag': 0, 'child': [{'activate': 1, 'obj_module': None, 'data_name': None, 'border': 5, 'size': (-1, -1), 'style': 0, 'span': (1, 1), 'component_module': None, 'proportion': 0, 'type': 'BoxSizer', 'res_module': None, 'hgap': 0, 'description': None, '_uuid': '1f4916eb-d78c-4f30-9168-fc21bf4064d6', 'flag': 0, 'child': [{'activate': 1, 'obj_module': None, 'show': 1, 'child': [{'activate': 1, 'disabledBitmap': None, 'name': 'add_tool', 'toolType': 0, 'shortHelpString': 'Добавить', 'longHelpString': '', '_uuid': '15ba70c1d4ab2f7373b333186092acd6', 'pushedBitmap': None, 'label': '', 'img_indx': -1, 'isToggle': 0, 'init_expr': None, 'bitmap': '@common.imgPlus', 'dis_img_indx': -1, 'push_img_indx': -1, 'type': 'ToolBarTool', 'onTool': 'GetInterface().onAddTool(event)', '__item_id': 17}, {'activate': 1, 'name': 'del_tool', 'toolType': 0, 'shortHelpString': 'Удалить', 'longHelpString': '', '_uuid': '62644b048005a3e4cb84cb11d21c0b3f', 'push_img_indx': -1, 'pushedBitmap': None, 'label': '', 'img_indx': -1, 'isToggle': 0, 'init_expr': None, 'bitmap': '@common.imgMinus', 'dis_img_indx': -1, 'disabledBitmap': None, 'type': 'ToolBarTool', 'onTool': 'GetInterface().onDelTool(event)', '__item_id': 18}, {'activate': 1, 'name': '_1462', '_uuid': 'a5ecd8ea547b9fb515748947c3b54002', 'init_expr': None, 'type': 'Separator', 'size': 5, '__item_id': 19}, {'activate': 1, 'name': 'set_tool', 'toolType': 0, 'shortHelpString': 'Сохранить', 'longHelpString': '', '_uuid': '4d27e4d06fd31e08caa8c9b28fb3cf68', 'push_img_indx': -1, 'pushedBitmap': None, 'label': '', 'img_indx': -1, 'isToggle': 0, 'init_expr': None, 'bitmap': '@common.imgCheck', 'dis_img_indx': -1, 'disabledBitmap': None, 'type': 'ToolBarTool', 'onTool': 'GetInterface().onSetTool(event)', '__item_id': 20}], 'image_list': None, 'refresh': None, 'border': 0, 'size': (-1, -1), 'style': 2097668, 'foregroundColor': None, 'span': (1, 1), 'alias': None, 'component_module': None, 'proportion': 0, 'source': None, 'backgroundColor': None, 'type': 'ToolBar', 'res_module': None, 'enable': True, 'description': None, '_uuid': 'aa4c26aab338b277f543442a7ecc3488', 'moveAfterInTabOrder': '', 'flag': 8192, 'recount': None, 'name': 'env_grid_toolbar', 'data_name': None, 'keyDown': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, 'bitmap_size': (16, 15), '__item_id': 16}, {'labelClick': None, 'activate': 1, 'obj_module': None, 'show': 1, 'col_count': 2, 'refresh': None, 'hrows': [], 'border': 0, 'size': (-1, -1), 'row_labels': ['1'], 'col_label_height': -1, 'moveAfterInTabOrder': '', 'foregroundColor': None, 'span': (1, 1), 'row_label_width': -1, 'cellSelect': None, 'source': None, 'component_module': None, 'proportion': 1, 'bReadonly': False, 'row_count': 1, 'backgroundColor': None, 'cellDClick': None, 'type': 'SimpleGrid', 'res_module': None, 'enable': True, 'description': None, 'selection_mode': 'cells', '_uuid': 'e1ea3b8f-4272-4f4b-96d8-54c5e7c1c978', 'style': 0, 'col_labels': ['Имя', 'Значение'], 'flag': 8192, 'alias': None, 'recount': None, 'child': [], 'name': 'env_grid', 'wcols': ['200', '500'], 'default_col_width': -1, 'default_row_height': -1, 'data_name': None, 'keyDown': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, 'cellChange': None, '__item_id': 21, '__attr_types__': {0: ['data_name', 'type', 'alias', 'moveAfterInTabOrder', 'field_name', 'name', 'label'], 40: ['default_row_height', 'col_count', 'default_col_width', 'row_label_width', 'border', 'col_label_height', 'proportion', 'row_count'], 20: ['col_labels', 'row_labels', 'wcols', 'hrows'], 1: ['layout', 'alignment', 'selection_mode'], 2: ['enable', 'bReadonly', 'activate'], 12: ['refresh', 'init_expr', 'show', 'source', 'description', 'recount', 'keyDown', 'pre_init_expr'], 8: ['foregroundColor', 'backgroundColor'], 9: ['font'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 17: ['res_module', '_uuid', 'obj_module']}, '__styles__': None, '__lists__': {'selection_mode': ['cells', 'rows', 'columns']}, '__events__': {'cellChange': ('wx.EVT_GRID_CELL_CHANGE', 'onCellChange', False), 'cellSelect': ('wx.EVT_GRID_SELECT_CELL', 'onCellSelect', False), 'cellDClick': ('wx.grid.EVT_GRID_CELL_LEFT_DCLICK', 'onDblClick', False), 'labelClick': ('wx.grid.EVT_GRID_LABEL_LEFT_CLICK', 'onLabelClick', False), 'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False), 'onInit': ('icEvents.EVT_POST_INIT', 'OnInit', False)}, '__version__icwidget': '0.0.0.0', '__default_page__': 0, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'foregroundColor': 'Цвет текста', 'backgroundColor': 'Цвет фона', 'show': 'Признак видимости', 'enable': 'Вкл./Выкл. объект', 'onInit': 'Обработчик инициализации объекта', 'keyDown': 'Обработчик нажатия кнопки клавиатуры', 'col_count': 'Количество колонок', 'row_count': 'Количество строк', 'col_labels': 'Надписи колонок', 'row_labels': 'Надписи строк', 'wcols': 'Размеры колонок', 'hrows': 'Размеры строк', 'row_label_width': 'Ширина надписей строк', 'col_label_height': 'Высота надписей колонок', 'default_row_height': 'Размер по умолчанию строк', 'default_col_width': 'Размер по умолчанию колонок', 'selection_mode': 'Режим выделения объектов грида', 'bReadonly': 'Не редакттируемые ячейки грида?'}}], 'layout': 'vertical', 'name': 'DefaultName_3200', 'alias': None, 'init_expr': None, 'position': (0, 0), 'vgap': 0, '__item_id': 15, '__attr_types__': {40: ['vgap, hgap', 'proportion', 'border'], 1: ['layout', 'alignment'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 12: ['init_expr', 'pre_init_expr', 'description'], 0: ['name', 'type', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 2: ['activate']}, '__lists__': {'layout': ['vertical', 'horizontal']}, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'vgap': 'Величина зазора между соседними ячейками по вертикали', 'hgap': 'Величина зазора между соседними ячейками по горизонтали', 'layout': 'Ориентация сайзера'}}], 'name': 'page2', 'data_name': None, 'keyDown': None, 'alias': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, '__item_id': 14}], 'titles': ['Основные', 'Дополнительные'], 'keyDown': None, 'images': [], 'border': 0, 'select': '0', 'size': (-1, -1), 'onRightMouseClick': None, 'style': 0, 'foregroundColor': None, 'span': (1, 1), 'component_module': None, 'proportion': 1, 'pageChanged': None, 'source': None, 'onLeftMouseClick': None, 'backgroundColor': None, 'type': 'Notebook', 'res_module': None, 'enable': True, 'description': None, '_uuid': '39f073d92ed3a646411304aef2aa3390', 'moveAfterInTabOrder': '', 'flag': 8192, 'recount': None, 'name': 'env_notebook', 'data_name': None, 'refresh': None, 'alias': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, '__item_id': 2}, {'activate': 1, 'obj_module': None, 'show': 1, 'attach_focus': False, 'data_name': None, 'mouseClick': "GetObject('envEditDialog').EndModal(wx.ID_OK)", 'font': {}, 'border': 5, 'size': (-1, -1), 'style': 0, 'foregroundColor': None, 'span': (1, 1), 'alias': None, 'component_module': None, 'proportion': 0, 'label': 'Закрыть', 'source': None, 'mouseDown': None, 'backgroundColor': None, 'type': 'Button', 'res_module': None, 'enable': True, 'description': None, '_uuid': 'e4087365-ea46-417f-b3ed-fc881c40de10', 'userAttr': None, 'moveAfterInTabOrder': '', 'flag': 2816, 'recount': None, 'name': 'close_button', 'mouseUp': None, 'keyDown': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, 'refresh': None, 'mouseContextDown': None, '__item_id': 22, '__attr_types__': {2: ['attach_focus', 'enable', 'activate'], 16: ['userAttr'], 0: ['moveAfterInTabOrder', 'field_name', 'alias', 'name', 'type', 'data_name', 'label'], 12: ['keyDown', 'recount', 'init_expr', 'description', 'refresh', 'show', 'source', 'pre_init_expr'], 8: ['foregroundColor', 'backgroundColor'], 9: ['font'], 10: ['span', 'position'], 11: ['size'], 7: ['style', 'flag'], 40: ['proportion', 'border'], 1: ['layout', 'alignment'], 17: ['_uuid', 'res_module', 'obj_module']}, '__events__': {'mouseClick': ('wx.EVT_BUTTON', 'onMouseClick', False), 'mouseContextDown': ('wx.EVT_RIGHT_DOWN', 'OnMouseContextDown', False), 'mouseDown': ('wx.EVT_LEFT_DOWN', 'OnMouseDown', False), 'mouseUp': ('wx.EVT_LEFT_UP', 'OnMouseUp', False), 'keyDown': ('wx.EVT_KEY_DOWN', 'OnKeyDown', False), 'onInit': ('icEvents.EVT_POST_INIT', 'OnInit', False)}, '__version__icwidget': '0.0.0.0', '__lists__': {'layout': ['vertical', 'horizontal'], 'alignment': ["('left', 'middle')", "('left', 'top')", "('left', 'bottom')", "('centred', 'middle')", "('centred', 'top')", "('centred', 'bottom')", "('right', 'middle')", "('right', 'top')", "('right', 'bottom')"]}, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'foregroundColor': 'Цвет текста', 'backgroundColor': 'Цвет фона', 'show': 'Признак видимости', 'enable': 'Вкл./Выкл. объект', 'onInit': 'Обработчик инициализации объекта', 'keyDown': 'Обработчик нажатия кнопки клавиатуры', 'mouseUp': 'Выражение, выполняемое после отпускания левой кнопки мыши', 'mouseContextDown': 'Выражение, выполняемое после нажатия правой кнопки мыши', 'attach_focus': 'Привязать фокус автоматически при создании'}}], 'layout': 'vertical', 'name': 'DefaultName_1481', 'alias': None, 'init_expr': None, 'position': (0, 0), 'vgap': 0, '__item_id': 1, '__attr_types__': {40: ['proportion', 'border', 'vgap, hgap'], 1: ['layout', 'alignment'], 10: ['position', 'span'], 11: ['size'], 7: ['flag', 'style'], 12: ['init_expr', 'description', 'pre_init_expr'], 0: ['type', 'name', 'alias', 'data_name'], 17: ['res_module', '_uuid', 'obj_module'], 2: ['activate']}, '__lists__': {'layout': ['vertical', 'horizontal']}, '__default_page__': 0, '__styles__': None, '__interface__': None, '__brief_attrs__': [], '__doc__': None, '__version__base': '0.0.0.0', '__version__': '0.0.0.0', '__init_res_by_wizard__': None, '__attr_hlp__': {'name': 'Имя объекта', 'type': 'Тип объекта', 'activate': 'Вкл./Выкл. создание объекта', 'data_name': 'Имя данных из контекста', 'description': 'Описание', 'style': 'Стиль компонента', 'init_expr': 'Выражение, выполняемой при инициализации компонента', 'component_module': 'Модуль компонента', 'res_module': 'Модуль ресурса', 'obj_module': 'Модуль объекта', 'size': 'Размер объекта', 'position': 'Позиция', 'span': 'Определяет сколько ячеек по горизонтали и вертикали должен занимать компонент', 'proportion': 'Признак пропорционального размера', 'flag': 'Флаг размещения', 'border': 'Величина отступа вокруг компонента', 'vgap': 'Величина зазора между соседними ячейками по вертикали', 'hgap': 'Величина зазора между соседними ячейками по горизонтали', 'layout': 'Ориентация сайзера'}}], 'icon': None, 'setFocus': None, 'name': 'envEditDialog', 'data_name': None, 'keyDown': None, 'alias': None, 'init_expr': None, 'position': (-1, -1), 'onInit': None, '__item_id': 0}

#   Version
__version__ = (1, 1, 1, 2)
###END SPECIAL BLOCK

#   Имя класса
ic_class_name = 'icEnvironmentEditDlg'


class icEnvironmentEditDlg(icobjectinterface.icObjectInterface):

    def __init__(self, parent, Context_=None, ProjectRoot_=None):
        """
        Конструктор интерфейса.
        """
        #   Вызываем конструктор базового класса
        icobjectinterface.icObjectInterface.__init__(self, parent, resource)

        try:
            viewer = self.GetNameObj('view_list')
            if Context_ is None:
                Context_ = glob_functions.getKernel().GetContext()
            variables = self._contextConvert(Context_)
            # log.debug(u'Переменные окружения: %s' % str(variables))
            var_list = [dict(name=var['__record__'][0],
                             value=var['__record__'][1],
                             access=var['__record__'][2],
                             lock_key=var['__record__'][3]) for var in variables]
            viewer.setDataset(var_list)
        except:
            log.fatal(u'Ошибка инициализации дерева просмотра хранилища переменных.')

        self._project_root = ProjectRoot_
        if self._project_root:
            try:
                env_grid = self.GetNameObj('env_grid')
                env_dict = self._project_root.prj_res_manager.getPrjEnv()
                env_list = list(env_dict.items())
                env_list.sort()
                log.debug(u'Окружение: <%s>' % env_list)
                env_grid.setTable(env_list)
            except:
                log.fatal(u'Ошибка инициализации грида редактирования дополнительных атрибутов проекта.')

    ###BEGIN EVENT BLOCK
    ###END EVENT BLOCK

    def _contextConvert(self, Context_):
        """
        Переконвертировать контекст в формат дерева.
        """
        result = []
        for name in Context_.keys():
            tree_item = {}
            context_item = Context_[name]
            tree_item['name'] = name
            tree_item['__record__'] = [name, str(context_item), '', '']
            result.append(tree_item)
        return result

    def design(self):
        """
        """
        self.getObject().ShowModal()

    def onAddTool(self, event=None):
        """
        Обработчик добавления новой записи в гриде дополнительных атрибутов проекта.
        """
        env_grid = self.GetNameObj('env_grid')
        env_grid.appendRow()

    def onDelTool(self, event=None):
        """
        Обработчик удаления выбранной записи в гриде дополнительных атрибутов проекта.
        """
        env_grid = self.GetNameObj('env_grid')
        env_grid.deleteCurRow()

    def onSetTool(self, event=None):
        """
        Обработчик сохранения отредактированных значений.
        """
        env_grid = self.GetNameObj('env_grid')
        env_list = env_grid.getTable()
        env_dict = None
        if env_list:
            env_dict = dict([(str(name), val) for name, val in env_list if name])
        if self._project_root and env_dict:
            self._project_root.prj_res_manager.setPrjEnv(env_dict)
            self._project_root.save()


def test(par=0):
    """
    Тестируем класс.
    """
    from ic.components import ictestapp
    app = ictestapp.TestApp(par)
    frame = wx.Frame(None, -1, 'Test')
    win = wx.Panel(frame, -1)

    #
    # Тестовый код
    #

    frame.Show(True)
    app.MainLoop()


if __name__ == '__main__':
    test()
